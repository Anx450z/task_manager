<%= javascript_include_tag 'tasks' %>
<%= render 'shared/navbar', show_home_page: false %>

<div class="container-wrapper">
  <% @containers.each do |container| %>
    <div class="container-card">
      <div>
        <b><%= container.tag %></b>
        <span><%= link_to 'Edit', edit_container_path(container), class: 'button' %></span>
      </div>
      <% container.tasks.order(:status).group_by(&:status).each do |status, tasks| %>
        <div class="status-card" id="status-card-<%= container %>-<%= status %>" data-expanded="true">
          <div class="status-card-header" onclick="toggleStatusCard('<%= container %>-<%= status %>')">
            <%= status %>
            <span class="caret">&#9660;</span>
            <span class="task-count"><%= tasks.count %> Tasks</span>
          </div>
           <div class="tasks-container">
            <% tasks.each do |task| %>
              <div class="task-card">
                <b><%= task.title %></b><br>
                <%= task.description %><br>
                <%= link_to 'Edit Task', edit_task_path(task), class: 'button' %>
              </div>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  <% end %>
</div>

<div class="floating-buttons">
  <%= link_to 'New Container', new_container_path, class: 'floating-button' %>
  <%= link_to 'New Task', new_task_path, class: 'floating-button' %>
</div>
